<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>For My Bunny ðŸ’œ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Lato:wght@300;400;700&display=swap" rel="stylesheet" />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html, body {
        font-family: "Lato", sans-serif;
        background: linear-gradient(135deg, #1a0a2e, #4a1942, #8b3a6a, #d4668a);
        background-size: 400% 400%;
        animation: gradientShift 20s ease infinite;
        height: 100%;
        width: 100%;
        overflow: hidden;
        position: fixed;
        color: #fff;
      }

      @keyframes gradientShift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }

      /* Floating hearts background */
      .floating-hearts {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1;
        overflow: hidden;
      }

      .bg-heart {
        position: absolute;
        font-size: 20px;
        animation: floatUp 8s linear infinite;
        opacity: 0.3;
      }

      @keyframes floatUp {
        0% {
          transform: translateY(100vh) rotate(0deg) scale(0);
          opacity: 0;
        }
        10% { opacity: 0.3; }
        90% { opacity: 0.3; }
        100% {
          transform: translateY(-100vh) rotate(360deg) scale(1.5);
          opacity: 0;
        }
      }

      /* Envelope Screen */
      #envelope-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        cursor: pointer;
        z-index: 10;
        transition: all 0.5s ease;
      }

      .envelope-wrapper {
        position: relative;
        animation: gentleFloat 3s ease-in-out infinite;
      }

      @keyframes gentleFloat {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-15px); }
      }

      .envelope-icon {
        width: 160px;
        height: 110px;
        position: relative;
        filter: drop-shadow(0 20px 40px rgba(0,0,0,0.4));
        transition: transform 0.3s ease;
      }

      #envelope-container:hover .envelope-icon {
        transform: scale(1.05) rotate(2deg);
      }

      .envelope-body {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 70%;
        background: linear-gradient(135deg, #ffe4ec, #ffc4d6);
        border-radius: 0 0 12px 12px;
        box-shadow: 0 15px 35px rgba(0,0,0,0.2);
      }

      .envelope-flap {
        position: absolute;
        top: 0;
        width: 100%;
        height: 55%;
        background: linear-gradient(135deg, #ffc4d6, #ff9eb5);
        clip-path: polygon(0 0, 50% 100%, 100% 0);
        transform-origin: top;
        border-radius: 12px 12px 0 0;
      }

      .envelope-heart {
        position: absolute;
        top: 55%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 32px;
        filter: drop-shadow(0 3px 6px rgba(0,0,0,0.2));
        animation: heartbeat 1.5s ease-in-out infinite;
      }

      @keyframes heartbeat {
        0%, 100% { transform: translate(-50%, -50%) scale(1); }
        25% { transform: translate(-50%, -50%) scale(1.2); }
        50% { transform: translate(-50%, -50%) scale(1); }
        75% { transform: translate(-50%, -50%) scale(1.1); }
      }

      .tap-text {
        margin-top: 35px;
        font-size: 14px;
        letter-spacing: 6px;
        text-transform: uppercase;
        opacity: 0.9;
        font-weight: 300;
        text-shadow: 0 2px 10px rgba(0,0,0,0.3);
      }

      .nickname-hint {
        margin-top: 15px;
        font-size: 18px;
        font-family: "Playfair Display", serif;
        font-style: italic;
        opacity: 0.8;
        animation: fadeInOut 3s ease-in-out infinite;
      }

      @keyframes fadeInOut {
        0%, 100% { opacity: 0.6; }
        50% { opacity: 1; }
      }

      /* Letter Screen */
      #letter-container {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        align-items: center;
        justify-content: center;
        padding: 15px;
        z-index: 20;
      }

      .letter-card {
        background: rgba(255, 255, 255, 0.97);
        backdrop-filter: blur(20px);
        border-radius: 30px;
        padding: 35px;
        width: 100%;
        max-width: 500px;
        max-height: 90vh;
        display: flex;
        flex-direction: column;
        box-shadow: 
          0 30px 60px rgba(0,0,0,0.3),
          0 0 0 1px rgba(255,255,255,0.2),
          inset 0 0 30px rgba(255,182,193,0.1);
        position: relative;
        overflow: visible;
        border: 1px solid rgba(255,255,255,0.3);
      }

      .content-area {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        width: 100%;
        position: relative;
        z-index: 2;
        overflow-y: auto;
        overflow-x: visible;
        padding: 10px;
        gap: 20px;
      }

      .content-area::-webkit-scrollbar {
        width: 6px;
      }

      .content-area::-webkit-scrollbar-track {
        background: transparent;
      }

      .content-area::-webkit-scrollbar-thumb {
        background: rgba(212,102,138,0.4);
        border-radius: 3px;
      }

      #letter-text {
        font-family: "Playfair Display", serif;
        font-size: 24px;
        color: #4a1942;
        line-height: 1.7;
        letter-spacing: 0.02em;
        text-align: center;
        width: 100%;
        font-weight: 400;
      }

      .cursor {
        display: inline-block;
        width: 2px;
        height: 1.1em;
        background: #d4668a;
        margin-left: 3px;
        animation: blink 1.2s infinite;
        vertical-align: middle;
      }

      @keyframes blink {
        0%, 50% { opacity: 1; }
        51%, 100% { opacity: 0; }
      }

      /* Cat Images */
      .cat-container {
        width: 150px;
        height: 150px;
        position: relative;
        flex-shrink: 0;
        display: none;
        align-items: center;
        justify-content: center;
      }

      .cat-container.show {
        display: flex;
      }

      .cat-img {
        max-width: 100%;
        max-height: 100%;
        border-radius: 20px;
        box-shadow: 0 15px 40px rgba(0,0,0,0.2);
      }

      .heart-accent {
        font-size: 36px;
        flex-shrink: 0;
        display: none;
        animation: heartbeat 1.5s ease-in-out infinite;
        filter: drop-shadow(0 5px 15px rgba(212,102,138,0.4));
      }

      .continue-btn {
        background: linear-gradient(135deg, #d4668a, #ff9eb5);
        color: white;
        border: none;
        padding: 16px 45px;
        border-radius: 30px;
        font-size: 16px;
        font-family: "Lato", sans-serif;
        font-weight: 700;
        letter-spacing: 3px;
        text-transform: uppercase;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 12px 35px rgba(212,102,138,0.35);
        display: none;
        flex-shrink: 0;
        position: relative;
        overflow: hidden;
        margin-top: 15px;
      }

      .continue-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        transition: left 0.5s;
      }

      .continue-btn:hover::before {
        left: 100%;
      }

      .continue-btn.show {
        display: block;
        animation: fadeInUp 0.6s ease;
      }

      .continue-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 18px 45px rgba(212,102,138,0.45);
      }

      @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }

      /* Buttons */
      .choice-area {
        display: none;
        flex-direction: column;
        align-items: center;
        gap: 20px;
        width: 100%;
        flex-shrink: 0;
        margin-top: 15px;
      }

      .btn-row {
        display: flex;
        gap: 20px;
        justify-content: center;
        flex-wrap: wrap;
        position: relative;
        width: 100%;
        min-height: 60px;
        align-items: center;
      }

      .btn {
        padding: 18px 45px;
        border: none;
        border-radius: 30px;
        font-size: 18px;
        font-family: "Lato", sans-serif;
        font-weight: 700;
        letter-spacing: 1.5px;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        flex-shrink: 0;
      }

      .btn-yes {
        background: linear-gradient(135deg, #d4668a, #ff9eb5);
        color: white;
        box-shadow: 0 12px 35px rgba(212,102,138,0.35);
      }

      .btn-yes:hover {
        transform: translateY(-3px) scale(1.03);
        box-shadow: 0 18px 45px rgba(212,102,138,0.45);
      }

      .btn-no {
        background: transparent;
        color: #aaa;
        border: 2px solid #ddd;
        font-weight: 400;
        transition: all 0.2s;
      }

      .btn-no:hover {
        border-color: #bbb;
        color: #888;
      }

      .no-wrapper {
        position: relative;
        display: inline-block;
      }

      .no-wrapper.running {
        position: fixed !important;
        z-index: 1000;
        transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      }

      /* Angry Screen */
      #angry-screen {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #2d1b2e, #1a0a1e);
        align-items: center;
        justify-content: center;
        flex-direction: column;
        z-index: 1000;
        padding: 20px;
      }

      .angry-content {
        text-align: center;
        max-width: 420px;
      }

      .angry-cat {
        width: 180px;
        height: 180px;
        margin: 0 auto 25px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .angry-cat-img {
        max-width: 100%;
        max-height: 100%;
        border-radius: 20px;
        box-shadow: 0 20px 50px rgba(255,107,107,0.4);
        animation: angryShake 0.4s ease-in-out infinite;
      }

      @keyframes angryShake {
        0%, 100% { transform: translateX(0) rotate(0deg); }
        25% { transform: translateX(-12px) rotate(-8deg); }
        75% { transform: translateX(12px) rotate(8deg); }
      }

      .how-dare-text {
        font-family: "Playfair Display", serif;
        font-size: 42px;
        color: #ff9eb5;
        margin-bottom: 20px;
        font-weight: 700;
        text-shadow: 0 4px 15px rgba(255,158,181,0.3);
        animation: popText 0.6s ease;
      }

      @keyframes popText {
        0% { transform: scale(0); opacity: 0; }
        60% { transform: scale(1.1); }
        100% { transform: scale(1); opacity: 1; }
      }

      .angry-subtext {
        font-size: 20px;
        color: rgba(255,255,255,0.85);
        line-height: 1.7;
        margin-bottom: 40px;
        font-weight: 300;
      }

      .btn-return {
        background: linear-gradient(135deg, #fff, #ffe4ec);
        color: #4a1942;
        padding: 18px 45px;
        border-radius: 30px;
        font-size: 17px;
        font-weight: 700;
        letter-spacing: 2px;
        border: none;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 12px 35px rgba(0,0,0,0.25);
      }

      .btn-return:hover {
        transform: translateY(-3px);
        box-shadow: 0 18px 45px rgba(0,0,0,0.35);
      }

      /* Success Screen */
      #success-screen {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #1a0a2e, #4a1942, #8b3a6a, #d4668a);
        background-size: 400% 400%;
        animation: gradientShift 15s ease infinite;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        z-index: 1000;
        text-align: center;
        padding: 20px;
        overflow-y: auto;
      }

      .success-content {
        max-width: 520px;
        animation: fadeInUp 1.2s ease;
        padding: 20px 0;
      }

      .success-cat {
        width: 200px;
        height: 200px;
        margin: 0 auto 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        animation: happyBounce 0.8s ease-in-out infinite;
      }

      @keyframes happyBounce {
        0%, 100% { transform: translateY(0) rotate(-3deg) scale(1); }
        50% { transform: translateY(-20px) rotate(3deg) scale(1.05); }
      }

      .success-cat-img {
        max-width: 100%;
        max-height: 100%;
        border-radius: 20px;
        box-shadow: 0 20px 50px rgba(255,182,193,0.5);
      }

      .success-title {
        font-family: "Playfair Display", serif;
        font-size: 52px;
        margin-bottom: 30px;
        background: linear-gradient(135deg, #fff, #ffb6c1, #ff9eb5);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-shadow: 0 10px 30px rgba(255,182,193,0.3);
      }

      .success-message {
        font-size: 23px;
        line-height: 2;
        color: rgba(255,255,255,0.95);
        font-weight: 300;
        font-family: "Playfair Display", serif;
      }

      .success-message strong {
        color: #ffb6c1;
        font-weight: 700;
      }

      .nicknames {
        margin-top: 30px;
        font-size: 18px;
        color: rgba(255,255,255,0.8);
        font-style: italic;
        letter-spacing: 2px;
      }

      /* Mobile */
      @media (max-width: 600px) {
        .letter-card {
          padding: 25px;
          max-height: 92vh;
          border-radius: 25px;
        }

        #letter-text {
          font-size: 21px;
        }

        .cat-container {
          width: 130px;
          height: 130px;
        }

        .angry-cat {
          width: 150px;
          height: 150px;
        }

        .success-cat {
          width: 170px;
          height: 170px;
        }

        .btn {
          padding: 16px 35px;
          font-size: 16px;
        }

        .how-dare-text {
          font-size: 36px;
        }

        .success-title {
          font-size: 42px;
        }

        .success-message {
          font-size: 20px;
        }
      }

      @media (max-height: 700px) {
        .letter-card {
          max-height: 95vh;
          padding: 20px;
        }

        .cat-container {
          width: 110px;
          height: 110px;
        }

        .heart-accent {
          font-size: 30px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Floating hearts background -->
    <div class="floating-hearts" id="bgHearts"></div>

    <!-- Envelope Screen -->
    <div id="envelope-container" onclick="openLetter()">
      <div class="envelope-wrapper">
        <div class="envelope-icon">
          <div class="envelope-flap"></div>
          <div class="envelope-body"></div>
          <div class="envelope-heart">ðŸ’œ</div>
        </div>
      </div>
      <div class="tap-text">Tap to Open</div>
      <div class="nickname-hint">for my lovely bunny...</div>
    </div>

    <!-- Letter Screen -->
    <div id="letter-container">
      <div class="letter-card">
        <div class="content-area" id="contentArea">
          <div id="letter-text"></div>
          
          <!-- Cat appears after Continue -->
          <div class="cat-container" id="catArt">
            <img src="cat_heart.gif" alt="Cute cat" class="cat-img" id="mainCat" />
          </div>

          <div class="heart-accent" id="heartAccent">ðŸ’•</div>

          <button class="continue-btn" id="continueBtn" onclick="continueToQuestion()">Continue</button>

          <div class="choice-area" id="choiceArea">
            <div class="btn-row" id="initialChoices">
              <button class="btn btn-yes" onclick="handleYes()">Yes, my love</button>
              <div class="no-wrapper" id="noWrapper">
                <button class="btn btn-no" id="noBtn" onclick="handleNo()" onmouseover="runAway()">No</button>
              </div>
            </div>
            
            <div class="btn-row" id="finalChoices" style="display: none;">
              <button class="btn btn-yes" onclick="handleYes()">Yes ðŸ’œ</button>
              <button class="btn btn-yes" onclick="handleYes()" style="background: linear-gradient(135deg, #ff69b4, #ff1493);">Absolutely Yes ðŸ’•</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Angry Screen -->
    <div id="angry-screen">
      <div class="angry-content">
        <div class="angry-cat">
          <img src="angry_cat.gif" alt="Angry cat" class="angry-cat-img" id="angryCat" />
        </div>
        <div class="how-dare-text">How Dare You!</div>
        <div class="angry-subtext">
          You can't say no to your bunny, lovely love!<br>
          Go back and choose wisely, dummydo!
        </div>
        <button class="btn-return" onclick="goBack()">Take me back, please ðŸ¥º</button>
      </div>
    </div>

    <!-- Success Screen -->
    <div id="success-screen">
      <div class="success-content">
        <div class="success-cat">
          <img src="cat_dance.gif" alt="Happy dancing cat" class="success-cat-img" id="happyCat" />
        </div>
        <div class="success-title">She Said Yes!</div>
        <div class="success-message">
          You've made me the <strong>happiest person</strong> in the universe.<br>
          Your smile brightens every corner of my world.<br>
          I promise to love my <strong>bunny</strong>, my <strong>lovely love</strong>, my <strong>dummydo</strong><br>
          with all my heart, today and always.
        </div>
        <div class="nicknames">forever yours, my everything ðŸ’œ</div>
      </div>
    </div>

    <script>
      let noCount = 0;
      let isFinalStage = false;

      const compliments = [
        "My dearest bunny,",
        "my lovely love,",
        "my sweet dummydo...",
        "You are the most precious soul",
        "I've ever had the privilege to know.",
        "Your smile illuminates my entire world,",
        "and your laughter is my favorite melody.",
        "Every moment with you is a treasure.",
        "I have something very important to ask..."
      ];

      // Create background hearts
      function createBgHearts() {
        const container = document.getElementById('bgHearts');
        const hearts = ['ðŸ’œ', 'ðŸ’–', 'ðŸ’•', 'ðŸ±', 'âœ¨'];
        
        setInterval(() => {
          const heart = document.createElement('div');
          heart.className = 'bg-heart';
          heart.innerHTML = hearts[Math.floor(Math.random() * hearts.length)];
          heart.style.left = Math.random() * 100 + 'vw';
          heart.style.fontSize = (Math.random() * 15 + 15) + 'px';
          heart.style.animationDuration = (Math.random() * 4 + 6) + 's';
          container.appendChild(heart);
          
          setTimeout(() => heart.remove(), 10000);
        }, 800);
      }
      createBgHearts();

      // Check if images exist, fallback to text if not
      function imageExists(src, callback) {
        const img = new Image();
        img.onload = () => callback(true);
        img.onerror = () => callback(false);
        img.src = src;
      }

      function openLetter() {
        document.getElementById('envelope-container').style.opacity = '0';
        setTimeout(() => {
          document.getElementById('envelope-container').style.display = 'none';
          document.getElementById('letter-container').style.display = 'flex';
          typeWriterEffect();
        }, 500);
      }

      function typeWriterEffect() {
        const textContainer = document.getElementById('letter-text');
        let currentLine = 0;
        let currentChar = 0;
        let displayText = '';

        function typeNext() {
          if (currentLine >= compliments.length) {
            document.getElementById('continueBtn').classList.add('show');
            return;
          }

          const line = compliments[currentLine];
          
          if (currentChar < line.length) {
            displayText += line.charAt(currentChar);
            textContainer.innerHTML = displayText + '<span class="cursor"></span>';
            currentChar++;
            setTimeout(typeNext, 55);
          } else {
            displayText += '<br><br>';
            currentLine++;
            currentChar = 0;
            setTimeout(typeNext, 450);
          }
        }

        typeNext();
      }

      function continueToQuestion() {
        document.getElementById('continueBtn').style.display = 'none';
        document.getElementById('catArt').classList.add('show');
        
        const textContainer = document.getElementById('letter-text');
        const question = "Will you be my Valentine?";
        let charIndex = 0;
        let typedText = '';

        function typeQuestion() {
          if (charIndex < question.length) {
            typedText += question.charAt(charIndex);
            textContainer.innerHTML = typedText + '<span class="cursor"></span>';
            charIndex++;
            setTimeout(typeQuestion, 75);
          } else {
            textContainer.innerHTML = typedText;
            document.getElementById('heartAccent').style.display = 'block';
            document.getElementById('choiceArea').style.display = 'flex';
          }
        }

        typeQuestion();
      }

      function runAway() {
        if (isFinalStage) return;
        
        const wrapper = document.getElementById('noWrapper');
        const btn = document.getElementById('noBtn');
        const card = document.querySelector('.letter-card');
        const cardRect = card.getBoundingClientRect();
        const btnRect = btn.getBoundingClientRect();
        
        const minX = 20;
        const minY = 120;
        const maxX = cardRect.width - btnRect.width - 20;
        const maxY = cardRect.height - btnRect.height - 20;
        
        const randomX = Math.floor(Math.random() * (maxX - minX) + minX);
        const randomY = Math.floor(Math.random() * (maxY - minY) + minY);
        
        wrapper.classList.add('running');
        wrapper.style.left = (cardRect.left + randomX) + 'px';
        wrapper.style.top = (cardRect.top + randomY) + 'px';
        
        const texts = ['No?', 'Really?', 'Think again', 'Are you sure?', 'ðŸ’”', 'Your bunny is sad'];
        if (Math.random() > 0.5) {
          btn.textContent = texts[Math.floor(Math.random() * texts.length)];
        }
      }

      function handleNo() {
        noCount++;
        
        if (noCount >= 3) {
          enterFinalStage();
        } else {
          document.getElementById('letter-container').style.display = 'none';
          document.getElementById('angry-screen').style.display = 'flex';
        }
      }

      function goBack() {
        document.getElementById('angry-screen').style.display = 'none';
        document.getElementById('letter-container').style.display = 'flex';
        
        const wrapper = document.getElementById('noWrapper');
        wrapper.classList.add('running');
        wrapper.style.position = 'relative';
        wrapper.style.left = 'auto';
        wrapper.style.top = 'auto';
        wrapper.classList.remove('running');
        document.getElementById('noBtn').textContent = 'No';
      }

      function enterFinalStage() {
        isFinalStage = true;
        document.getElementById('initialChoices').style.display = 'none';
        document.getElementById('finalChoices').style.display = 'flex';
        
        const textContainer = document.getElementById('letter-text');
        textContainer.innerHTML = "No more games, dummydo!<br>Say yes, my lovely love! ðŸ’œ";
      }

      function handleYes() {
        document.getElementById('letter-container').style.display = 'none';
        document.getElementById('angry-screen').style.display = 'none';
        document.getElementById('success-screen').style.display = 'flex';
      }
    </script>
  </body>
</html>
